#!/usr/bin/env bash
set -euo pipefail

OUT_DIR="out"
CMD="${1:-build}"

case "$CMD" in
  clean)
    echo "ğŸ§¹ Cleaning $OUT_DIR"
    rm -rf "$OUT_DIR"
    ;;
  
  build)
    echo "ğŸ”§ Compiling sources..."
    mkdir -p "$OUT_DIR"
    javac -d "$OUT_DIR" com/craftinginterpreters/lox/*.java
    echo "âœ… Build complete. Classes in $OUT_DIR"
    ;;
  
  run)
    echo "ğŸš€ Building and running..."
    mkdir -p "$OUT_DIR"
    javac -d "$OUT_DIR" com/craftinginterpreters/lox/*.java
    echo "âœ… Build complete. Starting program..."
    java -cp "$OUT_DIR" com.craftinginterpreters.lox.Lox
    ;;
  
  *)
    echo "â“ Unknown command: $CMD"
    echo "Usage: andey [clean|build|run]"
    exit 1
    ;;
esac
